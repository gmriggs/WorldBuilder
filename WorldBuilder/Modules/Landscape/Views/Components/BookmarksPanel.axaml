<UserControl
    x:Class="WorldBuilder.Modules.Landscape.Views.Components.BookmarksPanel"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:WorldBuilder.Lib.Converters"
    xmlns:i="using:Avalonia.Xaml.Interactivity"
    xmlns:ia="using:Avalonia.Xaml.Interactions.Core"
    xmlns:landscape="clr-namespace:WorldBuilder.Modules.Landscape.ViewModels"
    xmlns:viewmodels="clr-namespace:WorldBuilder.ViewModels"
    x:CompileBindings="False"
    x:DataType="landscape:BookmarksPanelViewModel">

    <UserControl.Resources>
    </UserControl.Resources>

    <DockPanel LastChildFill="True">
        <StackPanel Orientation="Vertical">
            <TextBlock
                Margin="8,8,8,4"
                FontWeight="Bold"
                Text="Bookmarks" />

            <ScrollViewer MaxHeight="300">
                <ListBox
                    x:Name="BookmarkListBox"
                    ItemsSource="{Binding Bookmarks}"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                    SelectedItem="{Binding SelectedBookmark}"
                    KeyDown="BookmarkListBox_KeyDown"
                    DoubleTapped="BookmarkListBox_DoubleTapped">
                    <ListBox.Styles>
                        <Style Selector="ListBoxItem">
                            <Setter Property="Padding" Value="8,4" />
                        </Style>
                    </ListBox.Styles>
                        <ListBox.ItemTemplate>
                            <DataTemplate x:DataType="viewmodels:Bookmark">
                                <DockPanel ToolTip.Tip="{Binding Location}" Background="Transparent">
                                    <StackPanel Orientation="Horizontal">
                                        <!-- Padding fixes odd rendering bug with Spacing -->
                                        <TextBlock Text="📍" Padding="0,0,7,0" />
                                        <TextBlock Text="{Binding Name}" />
                                    </StackPanel>
                                </DockPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    <ListBox.ContextMenu>
                        <ContextMenu>
                            <MenuItem
                                Command="{Binding GoToBookmarkCommand}"
                                CommandParameter="{Binding #BookmarkListBox.SelectedItem}"
                                Header="Go To" />
                            <MenuItem
                                Command="{Binding UpdateBookmarkCommand}"
                                CommandParameter="{Binding #BookmarkListBox.SelectedItem}"
                                Header="Update to Current Position" />
                            <MenuItem
                                Command="{Binding RenameBookmarkCommand}"
                                CommandParameter="{Binding #BookmarkListBox.SelectedItem}"
                                Header="Rename" />
                            <Separator />
                            <MenuItem
                                Command="{Binding MoveUpCommand}"
                                CommandParameter="{Binding #BookmarkListBox.SelectedItem}"
                                Header="Move Up" />
                            <MenuItem
                                Command="{Binding MoveDownCommand}"
                                CommandParameter="{Binding #BookmarkListBox.SelectedItem}"
                                Header="Move Down" />
                            <Separator />
                            <MenuItem
                                Command="{Binding DeleteBookmarkCommand}"
                                CommandParameter="{Binding #BookmarkListBox.SelectedItem}"
                                Header="Delete" />
                        </ContextMenu>
                    </ListBox.ContextMenu>
                </ListBox>
            </ScrollViewer>

            <StackPanel
                Margin="5"
                HorizontalAlignment="Right"
                DockPanel.Dock="Top"
                Orientation="Horizontal"
                Spacing="5">
                <StackPanel.Styles>
                    <Style Selector="Button">
                        <Setter Property="Width" Value="36" />
                        <Setter Property="Height" Value="24" />
                        <Setter Property="Padding" Value="0" />
                    </Style>
                </StackPanel.Styles>
                <Button
                    Command="{Binding AddBookmarkCommand}"
                    Content="+"
                    FontSize="18"
                    ToolTip.Tip="Bookmark Current Location (Ctrl+B)" />
                <Button
                    x:Name="GoToButton"
                    Command="{Binding GoToBookmarkCommand}"
                    CommandParameter="{Binding SelectedBookmark}"
                    Content="➜"
                    IsEnabled="{Binding SelectedBookmark, Converter={x:Static ObjectConverters.IsNotNull}}"
                    ToolTip.Tip="Go To Selected Bookmark" />
                <Button
                    Command="{Binding DeleteBookmarkCommand}"
                    CommandParameter="{Binding SelectedBookmark}"
                    Content="x"
                    IsEnabled="{Binding SelectedBookmark, Converter={x:Static ObjectConverters.IsNotNull}}"
                    ToolTip.Tip="Delete Selected Bookmark" />
            </StackPanel>
        </StackPanel>
    </DockPanel>
</UserControl>
